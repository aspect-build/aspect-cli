"""
In development 'test' task with an AXL powered UI.
"""

load("./lib/tui.axl", "tui")

def _test_impl(ctx):
    test = ctx.bazel.test(
        build_events = True,
        flags = ["--isatty=" + str(int(ctx.std.io.stdout.is_tty))],
        inherit_stderr = False,
        *ctx.args.target_pattern
    )
    return tui(ctx, test)

test = task(
    implementation = _test_impl,
    group = ["dev"],
    args = {
        "target_pattern": args.positional(minimum = 1, maximum = 512, default = ["..."]),
    }
)
