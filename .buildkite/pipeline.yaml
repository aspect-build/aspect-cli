# Generated by: aspect workflows migrate --host=buildkite
# Source: .aspect/workflows/config_aws.yaml
# DO NOT EDIT - regenerate with 'aspect workflows migrate'

env:
  PATH: "/home/aspect-runner/.aspect/bin:$PATH"
  ASPECT_DEBUG: "1"
steps:
  - key: __main__::debug
    label: ":bazel: Debug"
    agents:
      queue: aspect-default
    timeout_in_minutes: 20
    command:
      - cat /etc/aspect/workflows/platform/rosetta_api_tokens
      - echo ""
      - cat /etc/aspect/workflows/platform/api_client_id
      - echo ""
      - cat /etc/aspect/workflows/platform/api_key
      - echo ""
      - cat /etc/aspect/workflows/platform/brs_api_endpoint
      - echo ""
      - cat /etc/aspect/workflows/platform/az
      - echo ""
      - ls /etc/aspect/workflows/bin
  - key: __main__::build
    label: ":bazel: Build"
    agents:
      queue: aspect-default
    timeout_in_minutes: 20
    command:
      - |
        echo "--- :aspect-build: Workflows environment"
        /etc/aspect/workflows/bin/configure_workflows_env
        echo "--- :stethoscope: Agent health check"
        /etc/aspect/workflows/bin/agent_health_check
      - ls /etc/aspect/workflows/platform
      - aspect build ...
  - key: __main__::delivery
    label: ":ship: :package: :bazel: Delivery"
    agents:
      queue: aspect-default
    timeout_in_minutes: 20
    command:
      - |
        echo "--- :aspect-build: Workflows environment"
        /etc/aspect/workflows/bin/configure_workflows_env
        echo "--- :stethoscope: Agent health check"
        /etc/aspect/workflows/bin/agent_health_check
      - ls /tmp
      - aspect delivery --build_url $BUILDKITE_BUILD_URL --commit_sha $BUILDKITE_COMMIT --force_target //:hello -- //:hello //:hello2
